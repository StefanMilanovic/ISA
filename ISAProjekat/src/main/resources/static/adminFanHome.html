<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">

<script src="jquery-3.2.1.min.js"></script>

<title>Admin FanZone</title>

<script  type="text/javascript">
	$(document).on('click','a',function(e) { 
		e.preventDefault();
		var id = e.target.closest("div").childNodes[1].textContent;
		//console.log(id);
		getSelectedRekvizit(id);
	});
</script>
</head>
<body>



	<form id ="proveraOglasa" action="proveraOglasa.html" >
		<input type="submit" id="togglee" value="Provera Oglasa" />
	</form>
	<hr><br>
	<form action="adminFanAzuriraj.html">			      
	   <input type="submit" value="Azuriraj podatke">				        
	</form>
	<hr><br>
	<form action="dodajRekvizit.html">			      
	   <input type="submit" id="dodajRekvizit" value="Dodaj rekvizit">				        
	</form>
	<hr><br>
	
	
	<form id ="odjavaForma" method="GET" >
		<input type="button" id="odjavaDugme" value="Odjavi se" style="float:right" />
	</form>
	<hr><br>
	
	<h3>Prikaz postojecih rekvizita:</h3>
	<div id="rekviziti" > </div>
	
	<script type="text/javascript">
	 
	

$(document).ready(function(){
	console.log("Dokument spreman.");
	
	$.ajax({
		url:"http://localhost:8099/rekvizitController/getRekviziti",
		type:"GET",
		dataType:"json",
		success: function(data){
			//console.log(data);
			$.each(data, function(index, value){
				console.log(value);
				var text=
					"<div class=\"bioskop_div\">" +
						"<div class=\"thumbnail_div\">" +
						
						"</div>" +
						"<div class=\"podaci_div\">"+
							"<div class=\"naziv_div\">"+
								"<div class=\"ime_div\">"+
									"<a href=\"izmeniRekvizit.html\">"+value.naziv+"</a>"+
									"<label class=\"labela\" id=\"key\">"+value.id+"</label>"+
								"</div>"+
								"<div class=\"adresa_div\">"+
									"<h5>"+value.cena+"</h5>"+
								"</div>"+
							"</div>"+
							"<div class=\"opis_div\">"+
								"<p>"+value.opis+"</p>"+
							"</div>"+					
							"<div class=\"ocena_div\">"+
								"<h5>Slika :"+value.slika+"</h5>"+
							"</div>"+
							"</div>"+
						
					"</div>"+
				"<div class=\"razmak_div\"></div>";
				$("#rekviziti").append(text);
			});
		},
		error:function(textStatus,errorThrown){
			console.log("Ne valja nesto");
			console.log(textStatus);
		}
	});
});
	$("#odjavaDugme").click(function(){

					$.ajax({
						url: "http://localhost:8099/korisnikController/odjava",
						type: "GET",
						data: null,
						contentType: "application/json",
						datatype: 'json',
						success: function(data){
							
							if(data){
								location.href = "http://localhost:8099/index.html"	
								
							}else
								alert("Greska odjava!");
					
						},
						error: function(data){
							alert('Greskaaaa !')
							
						}
					});
				
			});	
	
	function getSelectedRekvizit(id){
		
		var id_data = JSON.stringify(id);
		
		$.ajax({
			url:"http://localhost:8099/rekvizitController/findClickedRekvizit",
			type:"POST",
			data:{id: id_data},
			dataType:"json",
			success:function(data){
				if(data==null){
					console.log("Data je null.");
				}
				else{
					console.log(data);
					top.location.href="izmeniRekvizit.html";
				}
			},
			error:function(textStatus, errorThrown){
				console.log(textStatus);
			}		
		});
		
		
	}

	
	</script>
</body>
</html>