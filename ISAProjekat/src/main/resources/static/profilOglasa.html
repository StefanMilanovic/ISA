<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<script src="jquery-3.2.1.min.js"></script>
<title>Odabran oglas</title>

<script type="text/javascript">
	$(document).ready(function(){
		console.log("Usao na odabran oglas.");

		$.ajax({
			url:"http://localhost:8099/oglasController/getSelectedOglas",
			type:"GET",
			dataType:"json",
			success:function(data){
				
				
				if(data == null){
					console.log("Data je null");
				}
				else{
					console.log("PISE DATA");
					console.log(data);
					console.log(data.naziv);
					
					
				}
				
				document.getElementById("naziv").value = data.naziv;
				document.getElementById("cena").value = data.cena;
				document.getElementById("opis").value = data.opis;
				document.getElementById("slika").value = data.slika;
				document.getElementById("datum").value = data.datum;
				document.getElementById('id').value=data.id;
				
			},
			error:function(textStatus, errorThrown){
				console.log("Ne valja nesto.")
				console.log(textStatus);
			}
		});		
	});

	</script>


</head>
<body>
<h1> Profil oglasa</h1>


<form id = "registrationForm" name = "registrationForm" method="POST">

			<label  for="cd-name">ID</label>
			<input  type="text" name="id" id="id" disabled><br/>
					
			<label  >Naziv</label><br/>
			<input id ="naziv" name ="naziv"  type="text" class="form-control"   disabled ><br/>
			
			<label>Cena</label><br/>
			<input id = "cena" name = "cena" type="text" class="form-control" placeholder= "Cena" disabled><br/> 
			
			<label > Opis :</label><br/>
			<input id = "opis" name = "opis" type="text" class="form-control"  placeholder="opis" disabled><br/> 
			
			<label>Slika</label><br/>
			<input id = "slika" name ="slika" class="form-control" placeholder="slika" disabled><br/>
			 
			<label>Datum</label><br/>
			<input id = "datum" name ="datum" class="form-control" placeholder="datum" disabled><br/>
			 
			
			<hr><br>
			<p>
				<input id="odobri" type="button" class="btn btn-info"  value="Odobri"> <pre>		 </pre>
				<input id="odbi" type="button" class="btn btn-info"  value="Odbi">
			</p>
		</form>
		<br><br>
		
		
		
		<form id ="nazadForma" action="proveraOglasa.html" class="form-horizontal">
					        
			<input type="submit" value="Odustani">				        
		</form> 


		<script type="text/javascript">
		
			$("#odobri").click(function(){
				
				var provera = true;
				var forma = $('form[id="registrationForm"]');
				
				var naziv = forma.find('[name=naziv]').val();
				var cena = forma.find('[name=cena]').val();
				var opis = forma.find('[name=opis]').val();
				var slika = forma.find('[name=slika]').val();
				var slika = forma.find('[name=datum]').val();
						
				if(provera) {
					
						
					formData = JSON.stringify({
						id:$("#registrationForm [name='id']").val(),
						naziv:$("#registrationForm [name='naziv']").val(),
						cena:$("#registrationForm [name='cena']").val(),
						opis:$("#registrationForm [name='opis']").val(),
						slika:$("#registrationForm [name='slika']").val(),

						datum:$("#registrationForm [name='datum']").val()
					   });
					
					$.ajax({// OVde si stao napravi kontroler za izmenu i posalji na dobru stranicu
						url: "http://localhost:8099/oglasController/odobri",
						type: "PUT",
						data: formData,
						contentType: "application/json",
						datatype: 'json',
						success: function(data){
							if(data){
								alert("Odobravanje uspesno");
								
								
								
								location.href = "http://localhost:8099/proveraOglasa.html" 			
							}else{
								alert("Odobravanje neuspesno!");
							}
						},
						error: function(data){
							alert('Greska podaci azuriranje!')
							
						}
					});
				}
			});	
			
	$("#odbi").click(function(){
				
				var provera = true;
				var forma = $('form[id="registrationForm"]');
				
				var naziv = forma.find('[name=naziv]').val();
				var cena = forma.find('[name=cena]').val();
				var opis = forma.find('[name=opis]').val();
				var slika = forma.find('[name=slika]').val();
				var slika = forma.find('[name=datum]').val();
						
				if(provera) {
					
						
					formData = JSON.stringify({
						id:$("#registrationForm [name='id']").val(),
						naziv:$("#registrationForm [name='naziv']").val(),
						cena:$("#registrationForm [name='cena']").val(),
						opis:$("#registrationForm [name='opis']").val(),
						slika:$("#registrationForm [name='slika']").val(),

						datum:$("#registrationForm [name='datum']").val()
					   });
					
					$.ajax({// OVde si stao napravi kontroler za izmenu i posalji na dobru stranicu
						url: "http://localhost:8099/oglasController/odbi",
						type: "PUT",
						data: formData,
						contentType: "application/json",
						datatype: 'json',
						success: function(data){
							if(data){
								alert("Odobravanje uspesno");
								
								
								
								location.href = "http://localhost:8099/proveraOglasa.html" 			
							}else{
								alert("Odobravanje neuspesno!");
							}
						},
						error: function(data){
							alert('Greska podaci azuriranje!')
							
						}
					});
				}
			});	
		</script>

	</body>
</html>